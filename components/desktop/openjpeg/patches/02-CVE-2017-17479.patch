From https://bugzilla.suse.com/attachment.cgi?id=768690

Discussion: https://github.com/uclouvain/openjpeg/issues/1044

CVE-2017-17479 stack-based buffer overflow in pgxtoimage in jpwl/convert.c

--- a/src/bin/jpwl/convert.c	2018-05-16 11:05:47.114253434 -0700
+++ b/src/bin/jpwl/convert.c	2018-05-16 11:07:25.861625039 -0700
@@ -1348,7 +1348,7 @@
     }
 
     fseek(f, 0, SEEK_SET);
-    if (fscanf(f, "PG%[ \t]%c%c%[ \t+-]%d%[ \t]%d%[ \t]%d", temp, &endian1,
+    if (fscanf(f, "PG%31[ \t]%c%c%31[ \t+-]%d%31[ \t]%d%31[ \t]%d", temp, &endian1,
                &endian2, signtmp, &prec, temp, &w, temp, &h) != 9) {
         fprintf(stderr,
                 "ERROR: Failed to read the right number of element from the fscanf() function!\n");
--- a/src/bin/jp3d/convert.c	2018-05-16 11:07:42.532907630 -0700
+++ b/src/bin/jp3d/convert.c	2018-05-16 11:08:07.515133345 -0700
@@ -297,7 +297,7 @@
         fprintf(stdout, "[INFO] Loading %s \n", pgxfiles[pos]);
 
         fseek(f, 0, SEEK_SET);
-        fscanf(f, "PG%[ \t]%c%c%[ \t+-]%d%[ \t]%d%[ \t]%d", temp, &endian1, &endian2,
+        fscanf(f, "PG%31[ \t]%c%c%31[ \t+-]%d%31[ \t]%d%31[ \t]%d", temp, &endian1, &endian2,
                signtmp, &prec, temp, &w, temp, &h);
 
         i = 0;
