Modified for perl 5.22 from

https://github.com/Perl/perl5/commit/43b2f4ef399e2fd7240b4eeb0658686ad95f8e62

--- perl-5.22.1/regcomp.c.old	2019-02-18 07:42:47.489308239 -0800
+++ perl-5.22.1/regcomp.c	2019-02-18 07:47:07.707066702 -0800
@@ -11213,7 +11213,7 @@
 
     RExC_parse++;	/* Skip past the '{' */
 
-    if (! (endbrace = strchr(RExC_parse, '}'))  /* no trailing brace */
+    if (! (endbrace = (char *) memchr(RExC_parse, '}', RExC_end - RExC_parse))  /* no trailing brace */
 	|| ! (endbrace == RExC_parse		/* nothing between the {} */
               || (endbrace - RExC_parse >= 2	/* U+ (bad hex is checked... */
                   && strnEQ(RExC_parse, "U+", 2)))) /* ... below for a better
@@ -11900,9 +11900,11 @@
             else {
                 STRLEN length;
                 char name = *RExC_parse;
-                char * endbrace;
+                char * endbrace = NULL;
                 RExC_parse += 2;
-                endbrace = strchr(RExC_parse, '}');
+                if (RExC_parse < RExC_end) {
+                    endbrace = (char *) memchr(RExC_parse, '}', RExC_end - RExC_parse);
+                }
 
                 if (! endbrace) {
                     vFAIL2("Missing right brace on \\%c{}", name);
